<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RentalMetrics â€“ UK Property Deal &amp; Yield Analysis Tool</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="container header-inner">
      <div>
        <img src="rentalmetrics-logo.jpg" alt="Rental Metrics" class="header-logo">
        <p class="subtitle">UK Property Deal Analysis</p>
      </div>
      <button type="button" id="darkModeToggle" class="dark-mode-toggle" title="Toggle dark mode">&#9790;</button>
    </div>
  </header>

  <main class="container">
    <div class="mode-toggle">
      <button type="button" class="mode-btn active" data-mode="analyser">Deal Analyser</button>
      <button type="button" class="mode-btn" data-mode="sdlt">SDLT Calculator Only</button>
    </div>
    <div class="layout">
      <section class="input-panel">
        <h2>Property Details</h2>
        <form id="dealForm" autocomplete="off">
          <div class="form-group">
            <label for="address">
              Address / Postcode
              <span class="tooltip" data-tip="Enter the property address or postcode for reference.">?</span>
            </label>
            <input type="text" id="address" placeholder="e.g. SW1A 1AA">
          </div>

          <div class="form-group buyer-type-group">
            <label>
              Buyer Type
              <span class="tooltip" data-tip="Select whether this is an additional/investment property (higher SDLT) or a first-time buyer purchase (lower SDLT).">?</span>
            </label>
            <div class="buyer-type-toggle">
              <button type="button" class="buyer-type-btn active" data-buyer="investor">Investor</button>
              <button type="button" class="buyer-type-btn" data-buyer="ftb">First-Time Buyer</button>
            </div>
          </div>

          <div class="form-group">
            <label for="price">
              Asking Price (&pound;)
              <span class="tooltip" data-tip="The listed or agreed purchase price of the property.">?</span>
            </label>
            <input type="number" id="price" min="0" step="any" required placeholder="e.g. 200000">
          </div>

          <div class="form-group analyser-only">
            <label for="monthlyRent">
              Expected Monthly Rent (&pound;)
              <span class="tooltip" data-tip="The rent you expect to receive each month from tenants.">?</span>
            </label>
            <input type="number" id="monthlyRent" min="0" step="any" required placeholder="e.g. 900">
          </div>

          <div class="form-group analyser-only">
            <label for="solicitorFees">
              Solicitor Fees (&pound;)
              <span class="tooltip" data-tip="Legal fees for the purchase. Default is &pound;1,500.">?</span>
            </label>
            <input type="number" id="solicitorFees" min="0" step="any" value="1500">
          </div>

          <h3 class="analyser-only">
            Additional Costs
            <span class="tooltip" data-tip="Add itemised costs such as refurb, repairs, decorating, EPC, EICR, surveys, etc.">?</span>
          </h3>

          <div id="costItemsList" class="analyser-only"></div>
          <button type="button" id="addCostItem" class="btn-add-item analyser-only">+ Add Cost Item</button>
          <div class="cost-total-row analyser-only">
            <span>Total Additional Costs:</span>
            <span id="costItemsTotal">&pound;0</span>
          </div>

          <h3 class="analyser-only">Yield Adjustments</h3>

          <div class="form-group analyser-only">
            <label for="runningCosts">
              Monthly Running Costs (&pound;)
              <span class="tooltip" data-tip="Ongoing monthly costs (insurance, maintenance, ground rent, service charge, etc). Letting agent fee is separate below.">?</span>
            </label>
            <input type="number" id="runningCosts" min="0" step="any" placeholder="e.g. 150">
          </div>

          <div class="form-group analyser-only">
            <label for="lettingAgentFee">
              Letting Agent Fee (%)
              <span class="tooltip" data-tip="Percentage of monthly rent charged by your letting/management agent. Tick the box to add 20% VAT on top.">?</span>
            </label>
            <div class="letting-agent-row">
              <input type="number" id="lettingAgentFee" min="0" max="100" step="any" placeholder="e.g. 10">
              <label class="toggle-checkbox vat-checkbox">
                <input type="checkbox" id="lettingAgentVat">
                <span class="toggle-checkbox-label">+ 20% VAT</span>
              </label>
            </div>
          </div>

          <h3 class="analyser-only">Target Offer Price</h3>

          <div class="form-group analyser-only">
            <label for="targetYield">
              Target Yield (%)
              <span class="tooltip" data-tip="Your desired net yield. The tool will calculate the maximum price to achieve this.">?</span>
            </label>
            <input type="number" id="targetYield" min="0" max="50" step="any" value="7.0">
          </div>

          <h3 class="mortgage-header analyser-only" id="mortgageToggle" style="cursor:pointer;">
            Mortgage Calculator <span class="mortgage-arrow">&#9654;</span>
            <span class="tooltip" data-tip="Click to expand. Adds monthly payments, cash flow and cash-on-cash return to your analysis.">?</span>
          </h3>

          <div id="mortgageFields" class="mortgage-fields analyser-only" style="display:none;">
            <div class="mortgage-include-row">
              <label class="toggle-checkbox">
                <input type="checkbox" id="includeMortgage" checked>
                <span class="toggle-checkbox-label">Include mortgage in analysis</span>
              </label>
            </div>
            <div id="mortgageInputs">
              <div class="form-row">
                <div class="form-group half">
                  <label for="depositAmount">
                    Deposit (&pound;)
                    <span class="tooltip" data-tip="The deposit amount you will put down. The rest will be the mortgage.">?</span>
                  </label>
                  <input type="number" id="depositAmount" min="0" step="any" placeholder="e.g. 40000">
                </div>
                <div class="form-group half">
                  <label for="interestRate">
                    Interest Rate (%)
                    <span class="tooltip" data-tip="Annual mortgage interest rate.">?</span>
                  </label>
                  <input type="number" id="interestRate" min="0" max="30" step="any" value="4.5">
                </div>
              </div>
              <div class="form-group">
                <label for="mortgageTerm">
                  Mortgage Term (years)
                  <span class="tooltip" data-tip="The length of the mortgage in years.">?</span>
                </label>
                <input type="number" id="mortgageTerm" min="1" max="40" step="1" value="25">
              </div>
              <button type="button" class="btn-mortgage-calc" id="mortgageCalcBtn">Calculate Mortgage</button>
              <div class="borrowing-summary" id="borrowingSummary" style="display:none;">
                <div class="borrowing-row">
                  <span class="borrowing-label">Cash Deposit</span>
                  <span class="borrowing-value" id="borrowingDeposit">&pound;0</span>
                </div>
                <div class="borrowing-row">
                  <span class="borrowing-label">SDLT</span>
                  <span class="borrowing-value" id="borrowingSDLT">&pound;0</span>
                </div>
                <div class="borrowing-row">
                  <span class="borrowing-label">Solicitor Fees</span>
                  <span class="borrowing-value" id="borrowingSolicitor">&pound;0</span>
                </div>
                <div class="borrowing-row borrowing-total">
                  <span class="borrowing-label">Amount to Borrow</span>
                  <span class="borrowing-value" id="borrowingAmount">&pound;0</span>
                </div>
              </div>
            </div>
          </div>

          <button type="submit" class="btn-calculate analyser-only">Analyse Deal</button>
          <button type="button" id="sdltCalcBtn" class="btn-calculate sdlt-only">Calculate SDLT</button>
          <button type="button" id="savePdfBtn" class="btn-save-pdf analyser-only" style="display:none;" onclick="printReport()">Save as PDF</button>
        </form>
      </section>

      <section class="results-panel" id="resultsPanel">
        <div class="results-placeholder">
          <p>Enter property details and click <strong>Analyse Deal</strong> to see results.</p>
        </div>
      </section>
    </div>

    <section class="map-section" id="mapSection" style="display:none;">
      <h2>Location</h2>
      <div id="mapContainer"></div>
    </section>

    <section class="history-section analyser-only" id="historySection">
      <h2>Comparison History</h2>
      <div id="historyList"></div>
    </section>

    <div id="printReport" class="print-report"></div>

    <footer class="disclaimer">
      <p><strong>Disclaimer:</strong> These calculations are estimates only and do not constitute financial or tax advice. SDLT rates and thresholds can change. Always consult a qualified professional before making investment decisions. This tool covers England &amp; Northern Ireland only (not Scotland LBTT or Wales LTT).</p>
    </footer>
  </main>

  <script src="app.js"></script>
</body>
</html>
